"use strict";function activate(){function t(t){if(0===t.meta.count)return createNotificationElement(),void notification.show("warning","no results");createTableElement(t),createPagerElement(t),createRowsLengthElement(t),createSearchElement(),createNotificationElement()}function e(t){createNotificationElement(),notification.show("danger",t)}service.getAll(table.pageTake,table.pageSkip,table.searchString,table.orderColumn,table.ascending).then(t).catch(e)}function rowLengthOnChange(){function t(t){createTableElement(t),createPagerElement(t),createRowsLengthElement(t)}function e(t){}service.getAll(table.pageTake,table.pageSkip,table.searchString,table.orderColumn,table.ascending).then(t).catch(e)}function pagerOnClick(){function t(t){createTableElement(t),createPagerElement(t),createRowsLengthElement(t)}function e(t){}service.getAll(table.pageTake,table.pageSkip,table.searchString,table.orderColumn,table.ascending).then(t).catch(e)}function tHeadOnClick(){function t(t){createTableElement(t),createPagerElement(t),createRowsLengthElement(t)}function e(t){}service.getAll(table.pageTake,table.pageSkip,table.searchString,table.orderColumn,table.ascending).then(t).catch(e)}function searchOnSubmit(){function t(t){if(0===t.meta.count)return notification.show("warning","Sorry, we did not find any results for the search term "+table.searchString),void(table.searchString="");createTableElement(t),createPagerElement(t),createRowsLengthElement(t)}function e(t){}service.getAll(table.pageTake,table.pageSkip,table.searchString,table.orderColumn,table.ascending).then(t).catch(e)}function createTableElement(t){table.setHeader(t),table.setBody(t),table.toHtml(),table.initializeEvents()}function createPagerElement(t){pager.setPages(t),pager.toHtml(),pager.initializeEvents()}function createRowsLengthElement(t){rowsLength.setOptions(t),rowsLength.toHtml(),rowsLength.initializeEvents()}function createSearchElement(){search.toHtml(),search.initializeEvents()}function createNotificationElement(){notification.toHtml(),notification.initializeEvents()}var resorce={init:function(t){return this.path=t,this},query:function(){return fetch(this.path).then(function(t){return t.json()}).then(function(t){return t})}},dataRepository={getAll:function(t,e,n,a,i){var l=Object.create(resorce).init("http://aleatorium.gear.host/api/albumRest?take="+t+"&skip="+e+"&searchString="+n+"&orderColumn="+a+"&ascending="+i);return new Promise(function(t,e){function n(e){return t(e)}function a(t){return e(t)}l.query().then(n).catch(a)})}},repository=Object.create(dataRepository),dataService={getAll:function(t,e,n,a,i){return new Promise(function(l,r){function o(t){return l(t)}function s(t){return r(t)}repository.getAll(t,e,n,a,i).then(o).catch(s)})}},table={init:function(t,e){return this.htmlElement=t,this.header=[],this.body=[],this.callbackClick=e,this.pageTake=10,this.pageSkip=0,this.pageCurrent=0,this.totalCount=0,this.searchString="",this.orderColumn="",this.ascending=!0,this},setHeader:function(t){this.header=Object.keys(t.multipleData[0])},setBody:function(t){var e=this;e.totalCount=t.meta.totalCount,e.orderColumn=t.meta.orderColumn,e.body=[],t.multipleData.forEach(function(t){var n=[];for(var a in t)t.hasOwnProperty(a)&&n.push(t[a]);e.body.push(n)})},toHtml:function(){for(var t=this;this.htmlElement.firstChild;)this.htmlElement.removeChild(this.htmlElement.firstChild);t.htmlElement.innerHTML=t.getTemplate();var e=!0,n=!1,a=void 0;try{for(var i,l=t.htmlElement.getElementsByTagName("th")[Symbol.iterator]();!(e=(i=l.next()).done);e=!0){var r=i.value;if(r.innerText===t.orderColumn){r.classList.add("active");var o=r.getElementsByTagName("i")[0];t.ascending?o.classList.add("glyphicon-sort-by-attributes"):o.classList.add("glyphicon-sort-by-attributes-alt")}}}catch(t){n=!0,a=t}finally{try{!e&&l.return&&l.return()}finally{if(n)throw a}}},createSummary:function(){var t=this,e=t.pageCurrent*t.pageTake+1,n=t.pageCurrent*t.pageTake+t.pageTake;return n=n>t.totalCount?t.totalCount:n,"Showing <span>"+e+"</span> to <span>"+n+"</span> of <span>"+t.totalCount+"</span> entries"},initializeEvents:function(){var t=this,e=!0,n=!1,a=void 0;try{for(var i,l=t.htmlElement.getElementsByTagName("th")[Symbol.iterator]();!(e=(i=l.next()).done);e=!0){i.value.addEventListener("click",function(){t.orderColumn===this.innerText?t.ascending=!t.ascending:(t.orderColumn=this.innerText,t.ascending=!0),t.callbackClick()},!1)}}catch(t){n=!0,a=t}finally{try{!e&&l.return&&l.return()}finally{if(n)throw a}}},getTemplate:function(){var t=this;return"<thead>\n                    <tr>"+t.header.map(function(t){return"<th>"+t+'<i class="glyphicon"></i></th>'}).join("")+"</tr>\n                </thead>\n                <tbody>\n                    "+t.body.map(function(t){return"<tr>"+t.map(function(t){return"<td>"+t+"</td>"}).join("")+"</tr>"}).join("")+'                    \n                </tbody>\n                <tfoot>\n                    <tr>\n                        <td colspan="'+t.header.length+'">'+t.createSummary()+"</td>\n                    </tr>\n                </tfoot>"}},rowsLengthSelector={init:function(t,e,n){return this.htmlElement=t,this.table=e,this.select=null,this.options=null,this.callbackChange=n,this},setOptions:function(t){this.options=Math.ceil(t.meta.totalCount/10)},toHtml:function(){for(var t=this;t.htmlElement.firstChild;)t.htmlElement.removeChild(t.htmlElement.firstChild);t.htmlElement.innerHTML=t.getTemplate();var e=!0,n=!1,a=void 0;try{for(var i,l=t.htmlElement.elements[Symbol.iterator]();!(e=(i=l.next()).done);e=!0){var r=i.value;"rows-length-element"===r.id&&(t.select=r)}}catch(t){n=!0,a=t}finally{try{!e&&l.return&&l.return()}finally{if(n)throw a}}t.select.value=t.table.pageTake},initializeEvents:function(){var t=this;t.select.addEventListener("change",function(){t.table.pageCurrent=0,t.table.pageTake=parseInt(this.value),t.table.pageSkip=0,t.callbackChange()},!1)},getTemplate:function(){for(var t=this,e="",n=1;n<=t.options;n++)e+='<option value="'+10*n+'">'+10*n+"</option>";return'<fieldset class="form-group">\n                    <label for="rows-length">Items by page:</label>\n                    <select class="form-control input-sm" id="rows-length-element">'+e+"</select>\n                </fieldset>"}},pager={init:function(t,e,n){return this.htmlElement=t,this.table=e,this.pages=null,this.callbackClick=n,this},setPages:function(t){var e=this;e.pages=Math.ceil(t.meta.totalCount/e.table.pageTake)},toHtml:function(){for(var t=this;t.htmlElement.firstChild;)t.htmlElement.removeChild(t.htmlElement.firstChild);t.htmlElement.innerHTML=t.getTemplate(t.pages),t.htmlElement.firstChild.childNodes[t.table.pageCurrent].classList.add("active")},initializeEvents:function(){var t=this,e=!0,n=!1,a=void 0;try{for(var i,l=t.htmlElement.firstChild.childNodes[Symbol.iterator]();!(e=(i=l.next()).done);e=!0){i.value.getElementsByTagName("a")[0].addEventListener("click",function(e){e.preventDefault(),t.htmlElement.firstChild.childNodes[t.table.pageCurrent].classList.remove("active"),t.table.pageCurrent=parseInt(this.getAttribute("href")-1),t.table.pageSkip=parseInt(this.getAttribute("href")-1)*t.table.pageTake,t.htmlElement.firstChild.childNodes[t.table.pageCurrent].classList.add("active"),t.callbackClick()},!1)}}catch(t){n=!0,a=t}finally{try{!e&&l.return&&l.return()}finally{if(n)throw a}}},getTemplate:function(t){for(var e="",n=1;n<=t;n++)e+='<li><a class="page-link" href="'+n+'">'+n+"</a></li>";return'<ul class="pagination pagination-sm" id="pagination-list">'+e+"</ul>"}},search={init:function(t,e,n){return this.htmlElement=t,this.table=e,this.callbackSubmit=n,this},toHtml:function(){var t=this;t.htmlElement.innerHTML=t.getTemplate()},initializeEvents:function(){var t=this;t.htmlElement.addEventListener("submit",function(e){e.preventDefault();var n=!0,a=!1,i=void 0;try{for(var l,r=this.elements[Symbol.iterator]();!(n=(l=r.next()).done);n=!0){var o=l.value;"search"===o.getAttribute("type")&&(t.table.searchString=o.value)}}catch(t){a=!0,i=t}finally{try{!n&&r.return&&r.return()}finally{if(a)throw i}}t.table.pageCurrent=0,t.table.pageTake=10,t.table.pageSkip=0,t.callbackSubmit()},!1)},getTemplate:function(){return'<fieldset class="form-group">\n                    <label for="input-search">Search: </label>\n                    <div class="input-group">\n                        <input class="form-control input-sm" type="search" placeholder="Search" name="search-term">\n                        <button class="input-group-addon">\n                            <i class="glyphicon glyphicon-search"></i>\n                        </button>\n                    </div>\n                </fieldset>'}},notification={init:function(t){return this.htmlElement=t,this.type=null,this.msg=null,this},toHtml:function(){for(var t=this;t.htmlElement.firstChild;)t.htmlElement.removeChild(t.htmlElement.firstChild);t.htmlElement.innerHTML=t.getTemplate()},show:function(t,e){var n=this;n.type=t,n.msg=e,n.htmlElement.getElementsByClassName("msg")[0].innerText=n.msg,n.htmlElement.classList.add("alert-"+n.type),n.htmlElement.style.display="block"},hide:function(){var t=this;t.type=null,t.msg=null,t.htmlElement.style.display="none"},initializeEvents:function(){var t=this;t.htmlElement.getElementsByClassName("btn-close")[0].addEventListener("click",function(){t.hide()},!1)},getTemplate:function(){return'<span class="msg">'+this.msg+'</span>\n                <button class="close btn-close" datadismiss="alert" arialabel="close">\n                    <span class="glyphicon glyphicon-remove" ariahidden="true"></span>\n                </button>'}},service=Object.create(dataService),table=Object.create(table).init(document.getElementById("leanTable"),tHeadOnClick),pager=Object.create(pager).init(document.getElementById("pager"),table,pagerOnClick),rowsLength=Object.create(rowsLengthSelector).init(document.getElementById("rows-length"),table,rowLengthOnChange),search=Object.create(search).init(document.getElementById("component-input-search"),table,searchOnSubmit),notification=Object.create(notification).init(document.getElementById("notification"));activate();